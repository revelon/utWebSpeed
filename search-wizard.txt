<script>

$(function() {

	// Messages
	var message_search, message_filter;
	switch (getTLD()) {
		case 'sk':
			message_search = 'Napíš, čo hľadáš, a vyber typ súboru.';
			message_filter = 'Výsledky hľadania si môžeš zoradiť. Pre typ súboru video, audio a obrázky je k dispozícii podrobnejšie filtrovanie.';
			break;
		case 'pl':
			message_search = 'Wpisz czego szukasz a następnie wybierz typ pliku.';
			message_filter = 'Wyniki wyszukiwania można sortować. Istnieją zaawansowane opcje filtrowania dla typów plików audio, wideo i zdjęcia.';
			break;
		case 'en':
		case 'net':
			message_search = 'Type in what you are looking for and select filetype.';
			message_filter = 'You can sort these search results. There are advanced filtering options for filetypes of audio, video and image.';
			break;
		default:
			message_search = 'Napiš, co hledáš, a vyber typ souboru.';
			message_filter = 'Výsledky hledání si můžeš seřadit. Pro typ souboru video, audio a obrázky je k dispozici podrobnější filtrování.';
			break;
	}

	// initialize when not Casper UA, avoid disclaimer and public folders
	if (navigator.userAgent.indexOf('CasperJS') == -1 && $('#search-submit').length) {

		if(!localStorage.getItem("wizard-msg-search")) {
			setTimeout(function() {
				$("body").addClass("wizard");
				$(".search").addClass("wizard-msg-show-1").append("<div id='tooltip' class='wizard-msg top show wizard-msg-1'><a href='#' class='close'><i class='fa fa-close'></i></a>"+message_search+"</div>");

				$(".wizard-msg-1 a.close, .head-search-submit").on( "click", function() {
					localStorage.setItem("wizard-msg-search", 1);
					$(".wizard-msg-1").removeClass("show").addClass("hide");
					setTimeout(function() {
						$("body").removeClass("wizard");
						$(".search").removeClass("wizard-msg-show-1");
						$(".wizard-msg-1").remove();
					}, 450);

					// Show filter wizard
					if ($(".switches-sort").length) {
						wizardShowFilter();
					}

				});				
			}, 500);
		}

		// Show filter wizard
		if ($(".switches-sort").length) {
			wizardShowFilter();
		}

		// Filter
		function wizardShowFilter() {
			if(localStorage.getItem("wizard-msg-search") == 1) {
				setTimeout(function() {
					if($('.search-result > div.item').length > 2) {

						$("body").addClass("wizard");
						$("html, body").animate({
							scrollTop: $(".sorting").offset().top - 60
						}, 1500);

						$(".sorting, .sorting-mobile-toggle").addClass("wizard-msg-show-2");
						$(".pg-section .pg-header").append("<div id='tooltip' class='wizard-msg top show wizard-msg-2'><a href='#' class='close'><i class='fa fa-close'></i></a>"+message_filter+"</div>");
						$(".switches-sort a, .switches input, .switches label, .wizard-msg-2 a.close, .sorting-mobile-toggle").on( "click", function() {
							localStorage.setItem("wizard-msg-search", 2);
							$(".wizard-msg-2").removeClass("show").addClass("hide");
							setTimeout(function() {
								$(".wizard-msg-2").remove();
								$("body").removeClass("wizard");
								$(".sorting, .sorting-mobile-toggle").removeClass("wizard-msg-show-2");
							}, 450);
						});
					}

				}, 1200);
			}
		}

	}

	// TLD
	function getTLD() {
		var hostName = window.location.hostname;
		var hostNameArray = hostName.split(".");
		var ret = hostNameArray[hostNameArray.length - 1];
		if (ret == 'nds') ret = hostNameArray[0]; // non-prod env case
		return ret;
	}

});


// DEBUG
$('body').append('<h1 style="cursor:pointer" onclick="javascript:wizReset()">RESET WIZARD</h1>');
function wizReset () {
	localStorage.removeItem("wizard-msg-search");
	console.log("localStorage wizard flag", localStorage.getItem("wizard-msg-search"));
}

</script>
