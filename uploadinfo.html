<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Simple file reporter</title>

<script src="https://static.uloz.to/content/spark-md5.min.js"></script>
<script>
var reportToSend = '', reportReady = false;
function updateSize() {
  var f = document.getElementById("uploadInput").files;
  reportToSend += "name=" + encodeURI(f[0].name) + "&size=" + f[0].size  + "&type=" + f[0].type + "&md5=";
  if (f[0].size < 500000000) {
    var reader = new FileReader();
    reader.onload = function(e) {
      reportToSend += SparkMD5.hashBinary(reader.result, false);
      reportReady = true;
    }
    reportReady = false;
    reader.readAsBinaryString(f[0]);
  } else {
    reportReady = true;
  }
  document.getElementById("uploadReportButton").removeAttribute("disabled");
}
function sendData() {
  if (reportReady) {
    document.getElementById('uploadReport').innerHTML = "<h4>Děkujeme za nahlášení!</h4><img width=1 src='https://uloz.to/uploadIssueReport?" + reportToSend + "'>";
  } else {
    alert ('Počkejte prosím, report k odeslání se ještě připravuje...');
  }
}
</script>
</head>

<body>


<form id="uploadReport">
  <h4>Máš problém nahrát nějaký soubor?</h4>
  <p>Pošli nam o tom zprávu, pokusíme se s tím něco udělat. Vyber problematický soubor, prosím: <input id="uploadInput" type="file" onchange="updateSize()"></p>
  <input id="uploadReportButton" type="button" value="Odeslat report" onclick="sendData()" disabled>
</form>

</body>
</html>